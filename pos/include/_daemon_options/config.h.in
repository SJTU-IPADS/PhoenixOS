/*
 * Copyright 2024 The PhoenixOS Authors. All rights reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
#pragma once

#include <iostream>
#include <string>

#include "pos/include/common.h"
#include "pos/include/log.h"

/*!
 *  \brief  hard-coded configurations of PhoenixOS
 */

// TSC frequency
// #define POS_TSC_FREQ 2200000000 // Hz
#define POS_TSC_FREQ                    @pos_tsc_freq@ // Hz

/*!
 *  \brief  configurations for continuous checkpoint
 */
// checkpoint optimization level
#define POS_CKPT_OPT_LEVEL              @pos_ckpt_opt_level@

// enable increamental checkpoint
#define POS_CKPT_ENABLE_INCREMENTAL     @pos_enable_ckpt_increamental@

// enable pipelined checkpoint
#define POS_CKPT_ENABLE_PIPELINE        @pos_enable_ckpt_pipeline@

// enable checkpoint orchestration
#define POS_CKPT_ENABLE_ORCHESTRATION   @pos_enable_ckpt_orchestration@

// checkpoint interval (unit in ms)
#define POS_CKPT_INTERVAL               @pos_ckpt_interval_ms@ // ms

/*!
 *  \brief  configurations for migration
 */
#define POS_MIGRATION_OPT_LEVEL         @pos_migration_opt_level@

static_assert(!(POS_CKPT_OPT_LEVEL > 0 && POS_MIGRATION_OPT_LEVEL > 0));

#define POS_ENABLE_CONTEXT_POOL         @pos_enable_context_pool@

/*!
 *  \brief  common checkpoint configurations
 */
// path to output log file
#define POS_LOG_FILE_PATH               "@pos_log_file_path@"

// prefill scale to the POS DAG
#define POS_NB_PREFILL_DAG_VERTEX               65536 // 1 << 16
#define POS_NB_PREFILL_DAG_VERTEX_NEIGHBOR      65536 // 1 << 16
