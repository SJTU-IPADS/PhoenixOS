#pragma once

#include <iostream>
#include <string>

#include "pos/include/common.h"
#include "pos/include/log.h"

/*!
 *  \brief  hard-coded configurations of PhoenixOS
 */

// TSC frequency
// #define POS_TSC_FREQ 2200000000 // Hz
#define POS_TSC_FREQ                    @pos_tsc_freq@ // Hz

// checkpoint optimization level
#define POS_CKPT_OPT_LEVEL              @pos_ckpt_opt_level@

/*!
 *  \brief  configurations for continuous checkpoint
 */
// enable increamental checkpoint
#define POS_CKPT_ENABLE_INCREMENTAL     @pos_enable_ckpt_increamental@

// enable pipelined checkpoint
#define POS_CKPT_ENABLE_PIPELINE        @pos_enable_ckpt_pipeline@

// enable checkpoint orchestration
#define POS_CKPT_ENABLE_ORCHESTRATION   @pos_enable_ckpt_orchestration@

// checkpoint interval (unit in ms)
#define POS_CKPT_INTERVAL               @pos_ckpt_interval_ms@ // ms

/*!
 *  \brief  configurations for preempt checkpoint
 */
// enable checkpoint after preempt
#define POS_CKPT_ENABLE_PREEMPT         @pos_enable_ckpt_preempt@
static_assert(
    (POS_CKPT_ENABLE_PREEMPT == 0)
    || (POS_CKPT_ENABLE_PREEMPT == 1 && POS_CKPT_OPT_LEVEL == 0)
);
// mock time to trigger preempt checkpoint
#define POS_CKPT_PREEMPT_TRIGGER_TIME_S   @pos_ckpt_preempt_trigger_time_s@

/*!
 *  \brief  common checkpoint configurations
 */
// path to output log file
#define POS_LOG_FILE_PATH               "@pos_log_file_path@"

// prefill scale to the POS DAG
#define POS_NB_PREFILL_DAG_VERTEX               65536 // 1 << 16
#define POS_NB_PREFILL_DAG_VERTEX_NEIGHBOR      65536 // 1 << 16
